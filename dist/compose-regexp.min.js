/**@license MIT-compose-regexp.js-©Pierre-Yves Gérardy*/
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define("compose-regexp",["exports"],n):(e="undefined"!=typeof globalThis?globalThis:e||self,n(e.composeRegexp={}))}(this,function(e){"use strict";function n(e){return e}function r(e){return-1===e.indexOf("\\")?e:JSON.parse('"'+e.replace(/$|"|\\x([\dA-Fa-f]{2})|\\u\{([\dA-Fa-f]{1,6})\}/g,function(e,n,r){return""===e?'"':'"'===e?'\\"':String.fromCodePoint(parseInt(n||r,16))}))}function t(){return"_"+Math.floor(Math.random()*Math.pow(2,32)).toString(36)}function u(){return{captureCount:null,direction:0,hasRefs:null,hasFinalRef:null,isDisjunction:null,isOneGroupOrAssertion:null,source:null,unicode:null}}function i(e){if(e instanceof Q){var n=X.get(e);return null==n&&X.set(e,n=u()),n}return e||u()}function o(e,n){return Object.defineProperty(function(r){var t=Y.get(r.key,e);return null!=t?t:Y.set(r.key,e,n(r))},"name",{value:e})}function l(e){return Y.get(e,"source")||Y.set(e,"source",e.source)}function f(e){function n(e){e.lastIndex=u.lastIndex,u=e}var t,u=ee;for(te.length=0,ee.lastIndex=0;t=u.exec(e);)if(u===ee)if("["===t[0])n(ne);else{if("."===t[0]||"[^]"===t[0]||null!=t[1]&&!re.test(r(t[1]))||null!=t[2])return!0;if(null!=t[3])te.unshift(t[3]);else if(null!=t[4]){if(("(?="===te[0]||"(?!"===te[0])&&")"!==t[4])return!0;te.shift()}}else if("]"===t[0])n(ee);else if(null!=t[1]||null!=t[2])return!0;return!1}function a(e){var n=e.source;if(null==n||"^"===n||"$"===n||"\\b"===n||"\\B"===n)throw new SyntaxError("Nothing to repeat: /"+(n||"(?:)")+"/");if(1===n.length||se.test(n)||q.U&&pe.test(n))return!1;if(!ce(e))return!0;if(/^\(\?<?[!=]/.test(n))throw new SyntaxError("Nothing to repeat: /"+n+"/");return!1}function c(e){var n=!1;return e.replace(de,function(e){if("["===e&&(n=!0),"]"===e){if(!n)return"\\]";n=!1}return n||"}"!==e?e:"\\}"})}function s(e){var n=e;return function(e){if("regexp"===e.kind||"result"===e.kind){if(le(e)){J.hasRefs=!0;var r=!1;e.source=e.source.replace(oe,function(e,t,u,i){if(!r){if(null!=t){var o=Number(t)+n;if(o>99)throw new RangeError("Too many back references");return"\\"+String(o)}if(null!=u)return"0"===u?"\\"+String(i):"(?:$ ^d:"+(Number(u)-1)+",n:"+i+")"}return"["===e?r=!0:"]"===e&&(r=!1),e})}J.hasFinalRef=!!Y.get(e.key,"hasFinalRef"),n+=ie(e)}return J.captureCount=n,e}}function p(e){var n=e.source;if(q.U&&("regexp"===e.kind&&!e.key.unicode||"result"===e.kind&&!Y.get(e.key,"unicode"))){if(f(n))throw new SyntaxError("Can't upgrade the RegExp to Unicode /"+n+"/"+e.kind=="regexp"?e.key.flags:"");e.source=c(n)}var r=!1;return"regexp"===e.kind&&(e.key.dotAll||e.key.multiline)&&(e.source=n.replace(ge,function(n){return r?("]"===n&&(r=!1),n):("["===n&&(r=!0),e.key.dotAll&&"."===n?"[^]":e.key.multiline&&"^"===n&&G?"(?:^|(?<=[\\n\\r\\u2028\\u2029]))":e.key.multiline&&"$"===n&&G?"(?:$|(?=[\\n\\r\\u2028\\u2029]))":n)})),e}function d(e){var n=e.key.flags;if(!ye.test(n))throw new TypeError("Unkown flags: "+n.replace(new RegExp("["+z.join()+"]","g"),""));var r=!!e.key.unicode,t=e.key.ignoreCase,u=e.key.multiline;if(null!=q.I&&t!==q.I)throw new SyntaxError("Can't combine i and non-i regexps: "+e.key);if(!G&&null!=q.M&&t!==q.M)throw new SyntaxError("Can't combine m and non-m regexps: "+e.key);return q.I=t,q.M=u,q.U=q.U||r,e}function g(e){var n=Y.get(e.key,"direction");if(n*xe.current==-1)throw new TypeError("Illegal "+he[n]+" RegExp argument while building a "+he[xe.current]+" one: /"+e.source+"/");return 0!==n&&(J.hasRefs=!0),e}function y(e){return e?function(e,n){return e.source=null==e.source?n.source:n.source+"|"+e.source,e}:function(e,n){return e.source=null==e.source?n.source:n.source+("string"!==n.kind&&le(n)&&Y.get(n.key,"hasFinalRef")&&/^\d/.test(e.source)?"(?:)":"")+e.source,e}}function h(){J={hasRefs:!1,hasFinalRef:!1,captureCount:0},q={U:!1,I:null,M:null}}function x(e){var n=J,r=q;try{return e()}finally{J=n,q=r}}function w(e,n){return n.condition&&!n.condition(e)||(e.source=n.wrapper[0]+(e.source||"")+n.wrapper[1]),n.suffix&&(e.source+=n.suffix),e}function k(e){return w(e,{condition:function(e){return("regexp"===e.kind||"result"===e.kind)&&ae(e)},wrapper:["(?:",")"]})}function v(e){if("number"==typeof e||"string"==typeof e)return{key:null,kind:"string",source:String(e).replace(we,"\\$&")};throw new TypeError("Can't compose type "+typeof e+" as RegExp")}function m(e,r,t,u){return t=t||e.length>1,K.call(e,function e(u){return(!r&&t?k:n)(Array.isArray(u)?m(u,!1,t,0):"function"==typeof u?e(x(u)):u instanceof Q?g(d({key:u,kind:"regexp",source:l(u)})):v(u))}).map(p).map(s(u)).reduceRight(y(r),{key:Y.set(null,Object.assign({direction:J.hasRefs?xe.current:0,isDisjunction:r&&(e.length>1||1===e.length&&e[0]instanceof Q&&Y.get(e[0],"isDisjunction")),unicode:q.U},J)),kind:"result",source:null})}function b(){return(q.I?"i":"")+(G?"":q.M?"m":"")+(q.U?"u":"")}function E(e,n){n=n||{};var r=H.call(n,"flags")?n.flagsOp(b(),n.flags):b(),t=new RegExp(e.source||"",r);return Y.set(t,Y.set(e.key,{})),Y.set(t,"source",e.source),H.call(n,"direction")&&Y.set(t,"direction",n.direction),t}function R(){return arguments.length?(h(),E(m(arguments,!0,!1,0))):ke}function $(){return m(arguments,!1,!1,0)}function S(){return arguments.length?(h(),E($.apply(null,arguments))):ke}function O(e,n,r){return function(){if(!arguments.length)return ke;var t=xe.current;xe.current=r;try{h();return E(w($.apply(null,arguments),{wrapper:[e,n]}),{direction:0})}finally{xe.current=t}}}function I(){return h(),E(w($e.apply($,arguments),{condition:a,wrapper:["(?:",")"],suffix:this}))}function j(e){"string"!=typeof e&&(e="{"+String(e)+"}");var n=e.match(Re);if(!n||n[2]&&Number(n[2])<Number(n[1]))throw new SyntaxError("Invalid suffix '"+e+"'.");return 1===arguments.length?I.bind(e,e):I.apply(e,arguments)}function A(e){return!Z||re.test(r(e))}function _(e){var n=typeof e;return"string"===n&&A(e)||"number"===n&&0<e&&Math.round(e)===e}function C(e,n){if(!_(e))throw new SyntaxError("Bad ref: "+e);if(null!=n&&("number"!=typeof n||n<1||n!==n|0))throw new RangeError("Bad depth: "+n);if("string"==typeof e)return new RegExp("\\k<"+e+">");var r=new RegExp("(?:$ ^d:"+(n||"0")+",n:"+e+")");return Y.set(r,{direction:xe.current,hasFinalRef:!0,hasRefs:!0}),r}function M(){return h(),E(w(m(arguments,!1,!1,1),{wrapper:["(",")"]}))}function D(e){if("string"!=typeof e)throw new TypeError("String expected, got "+typeof e);return A(e),h(),E(w(m(L.call(arguments,1),!1,!1,1),{wrapper:["(?<"+e+">",")"]}))}function U(e){return 1===arguments.length?D.bind(null,e):D.apply(null,arguments)}function F(){return 1===xe.current?S(ve(M.apply(null,arguments)),C(1)):S(C(1),be(M.apply(null,arguments)))}function T(e,n){return e=e.split(""),n.split("").forEach(function(n){-1===e.indexOf(n)&&e.push(n)}),e.sort().join("")}function B(e){return h(),-1!==e.indexOf("u")&&(q.U=!0),E($e.apply($,arguments),{flagsOp:this,flags:e})}function N(e,n){return S(me(n),e)}function P(e,n){return S(me(N(e,n)),e)}function W(){return R([Ee.apply(null,arguments),ve.apply(null,arguments)],[be.apply(null,arguments),me.apply(null,arguments)])}var z=[];"dgimsuy".split("").forEach(function(e){try{new RegExp("",e),z.push(e)}catch(e){}});var Z=-1!==z.indexOf("u"),G=!1;try{new RegExp("(?<=)"),G=!0}catch(e){}var q,J,H={}.hasOwnProperty,K=[].map,L=[].slice,Q=RegExp,V={value:void 0,writable:!1,enumerable:!1,configurable:!1},X={key:"__$$__compose_regexp__$$__"+t()+t()+t()+t(),set:function(e,n){var r=typeof e;if(null==e||"object"!==r&&"function"!==r)throw new TypeError("Bad WeakMap key");var t=e[X.key];if(!t)return V.value={keys:[this],values:[n]},Object.defineProperty(e,X.key,V),this;var u=t.keys.indexOf(this);return 0===u?(t.keys.push(this),t.values.push(n),this):(t.values[u]=n,this)},get:function(e){var n=e[X.key];if(n){var r=n.keys.indexOf(this);if(-1!==r)return n.values[r]}}},Y={set:function(e,n,r){var t=i(e);return"object"==typeof n?Object.assign(t,n):t[n]=r},get:function(e,n){return i(e)[n]}},ee=/\\u\d{4}|\\x\d{2}|\\k<(.*?)>|\\c[A-Za-z]|\\([^.?*+^$[\]\\(){}|\/DSWdswBbfnrtv])|\[\^\]|\.|[\[]|(\((?:\?[^])?)|(\)(?:[+?*]|\{\d+,?\d?\})?)/g,ne=/\\u\d{4}|\\x\d{2}|\\c[A-Za-z]|(\\[DSWdsw]-[^\]]|.-\\[DSWdsw])|\\([^.?*+^$[\]\\(){}|\/DSWdswfnrtv-])|[\]]/g,re=Z&&new RegExp("^[_$\\p{ID_Start}][$\\p{ID_Continue}]*","u"),te=[],ue=/\\[^]|\(\?[^<]|[\[\](]/g,ie=o("captureCount",function(e){var n,r=0;for(ue.lastIndex=0;n=ue.exec(e.source);)"("===n[0]&&(r+=1);return r}),oe=/\\[^1-9]|[\[\]]|\\(\d{1,2})|\(\?:\$ \^d:(\d+),n:(\d+)\)/g,le=o("hasRefs",function(e){var n,r=!1,t=!1,u=!1;for(oe.lastIndex=0;n=oe.exec(e.source);)u||null==n[1]&&null==n[2]?"["===n[0]?u=!0:"]"===n[0]&&(u=!1):(r=!0,oe.lastIndex===e.source.length&&(t=!0));return Y.set(e.key,"hasFinalRef",t),r}),fe=/(\\.)|[-()|\[\]]((?=\?(?:=|!|<=|<!))?)/g,ae=o("isDisjunction",function(e){if(-1===e.source.indexOf("|"))return!1;var n,r=0,t=!1;for(fe.lastIndex=0;n=fe.exec(e.source);)if(null==n[1]&&(t||"("!==n[0]||r++,t||")"!==n[0]||r--,t||"["!==n[0]&&"[-"!==n[0]||(t=!0),t&&"]"===n[0]&&(t=!1),0===r&&!t&&"|"===n[0]))return!0;return!1}),ce=o("isOneGroupOrAssertion",function(e){var n=e.source;if("("!==n.charAt(0)||")"!==n.charAt(n.length-1))return!1;var r,t=0,u=!1;for(fe.lastIndex=0;r=fe.exec(n);)if(null==r[1]){if(u||"("!==r[0]||t++,!u&&")"===r[0]&&0===--t&&r.index!==n.length-1)return!1;u||"["!==r[0]&&"[-"!==r||(u=!0),u&&"]"===r[0]&&(u=!1)}else if(r.index===n.length-2)return!1;return!0}),se=/^\\[^]$|^\[(?:\\[^]|[^\]])*\]$/,pe=/^\\p\{[A-Z-a-z][A-Za-z=]*\}$/,de=/\{\d+,?\d*\}|\\[^]|\]|\[|\}/g,ge=/\\.|\.|\(\?:\^\|\(\?<=\[\\n\\r\\u2028\\u2029\]\)\)|\(\?:\$\|\(\?=\[\\n\\r\\u2028\\u2029\]\)\)|\[|\]|\^|\$/g,ye=new RegExp("^(?:(["+z.join("")+"])(?!.*\\1))*$"),he={"-1":"backward",1:"forward"},xe={current:1},we=/[.?*+^$[\]\\(){}|]/g,ke=/(?:)/,ve=O("(?=",")",1),me=O("(?!",")",1),be=O("(?<=",")",-1),Ee=O("(?<!",")",-1),Re=/^(?:\+|\*|\?|\{(\d+),?(\d*)\})\??$/,$e=I.call,Se=j("?"),Oe={add:function(e){if("string"!=typeof e)throw TypeError("String expected as first argument, got "+typeof e);if(!ye.test(e))throw new SyntaxError("Invalid flags: "+e);return 1===arguments.length?B.bind(T,e):B.apply(T,arguments)}},Ie={union:R,difference:N,intersection:P};e.atomic=F,e.avoid=me,e.bound=W,e.capture=M,e.charSet=Ie,e.either=R,e.flags=Oe,e.lookAhead=ve,e.lookBehind=be,e.maybe=Se,e.namedCapture=U,e.notBehind=Ee,e.ref=C,e.sequence=S,e.suffix=j,Object.defineProperty(e,"__esModule",{value:!0})});
