/**@license MIT-compose-regexp.js-©Pierre-Yves Gérardy*/
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define("compose-regexp",["exports"],n):(e="undefined"!=typeof globalThis?globalThis:e||self,n(e.composeRegexp={}))}(this,function(e){"use strict";function n(e){return e}function r(e){return-1===e.indexOf("\\")?e:JSON.parse('"'+e.replace(/$|"|\\x([\dA-Fa-f]{2})|\\u\{([\dA-Fa-f]{1,6})\}/g,function(e,n,r){return""===e?'"':'"'===e?'\\"':String.fromCodePoint(parseInt(n||r,16))}))}function t(){return"_"+Math.floor(Math.random()*Math.pow(2,32)).toString(36)}function u(){return{captureCount:null,direction:0,hasRefs:null,hasFinalRef:null,isDisjunction:null,isOneGroupOrAssertion:null,source:null,unicode:null}}function i(e){if(e instanceof Y){var n=ne.get(e);return null==n&&ne.set(e,n=u()),n}return e||u()}function o(e,n){return Object.defineProperty(function(r){var t=ye.get(r.key,e);return null!=t?t:ye.set(r.key,e,n(r))},"name",{value:e})}function f(e){return ye.get(e,"source")||ye.set(e,"source",e.source)}function c(e){function n(e){e.lastIndex=u.lastIndex,u=e}var t,u=he;for(xe.length=0,he.lastIndex=0;t=u.exec(e);)if(u===he)if("["===t[0])n(ge);else{if("."===t[0]||"[^]"===t[0]||null!=t[1]&&!ue.test(r(t[1]))||null!=t[2])return!0;if(null!=t[3])xe.unshift(t[3]);else if(null!=t[4]){if(("(?="===xe[0]||"(?!"===xe[0])&&")"!==t[4])return!0;xe.shift()}}else if("]"===t[0])n(he);else if(null!=t[1]||null!=t[2])return!0;return!1}function l(e){var n=e.source;if(null==n||"^"===n||"$"===n||"\\b"===n||"\\B"===n)throw new SyntaxError("Nothing to repeat: /"+(n||"(?:)")+"/");if(1===n.length||le.test(n)||K.U&&ae.test(n))return!1;if(!me(e))return!0;if(/^\(\?<?[!=]/.test(n))throw new SyntaxError("Nothing to repeat: /"+n+"/");return!1}function a(e){var n=!1;return e.replace(ie,function(e,r){if("]"===e){if(!n)return"\\]";n=!1}else if(!n&&null!=r){if("["!==r)return"\\"+r;n=!0}return e})}function s(e){var n=e;return function(r){if("regexp"===r.kind||"result"===r.kind){if(ke(r)){L.hasRefs=!0;var t=!1;r.source=r.source.replace(ce,function(r,u,i,o){if(!t){if(null!=u){var f=Number(u)+n;if(f>99)throw new RangeError("Back reference index larger than 99");return"\\"+String(f)}if(null!=i){if("0"===i){var f=Number(o)+e;if(f>99)throw new RangeError("Back reference index larger than 99");return"\\"+String(f)}return"$d:"+(Number(i)-1)+",n:"+o+"^"}}return"["===r?t=!0:"]"===r&&(t=!1),r})}L.hasFinalRef=!!ye.get(r.key,"hasFinalRef"),n+=we(r)}return L.captureCount=n,r}}function p(e){var n=e.source;if(K.U&&("regexp"===e.kind&&!e.key.unicode||"result"===e.kind&&!ye.get(e.key,"unicode"))){if(c(n))throw new SyntaxError("Can't upgrade the RegExp to Unicode /"+n+"/"+("regexp"===e.kind?e.key.flags:""));e.source=a(n)}var r=!1;return"regexp"===e.kind&&(e.key.dotAll||e.key.multiline)&&(e.source=n.replace(te,function(n){return r?("]"===n&&(r=!1),n):("["===n&&(r=!0),e.key.dotAll&&"."===n?"[^]":e.key.multiline&&"^"===n&&H?fe.source:e.key.multiline&&"$"===n&&H?oe.source:n)})),e}function d(e){var n=e.key.flags;if(!be.test(n))throw new TypeError("Unkown flags: "+n.replace(new RegExp("["+G.join()+"]","g"),""));var r=!!e.key.unicode,t=e.key.ignoreCase,u=e.key.multiline;if(null!=K.I&&t!==K.I)throw new SyntaxError("Can't combine i and non-i regexps: "+e.key);if(!H&&null!=K.M&&u!==K.M)throw new SyntaxError("Can't combine m and non-m regexps: "+e.key);return K.I=t,K.M=u,K.U=K.U||r,e}function g(e){var n=ye.get(e.key,"direction");if(n*Re.current==-1)throw new TypeError("Illegal "+Ee[n]+" RegExp argument while building a "+Ee[Re.current]+" one: /"+e.source+"/");return 0!==n&&(L.hasRefs=!0),e}function h(e){return e?function(e,n){return e.source=null==e.source?n.source:n.source+"|"+e.source,e}:function(e,n){return e.source=null==e.source?n.source:n.source+("string"!==n.kind&&ke(n)&&ye.get(n.key,"hasFinalRef")&&/^\d/.test(e.source)?"(?:)":"")+e.source,e}}function y(){L={hasRefs:!1,hasFinalRef:!1,captureCount:0},K={U:!1,I:null,M:null}}function x(e){var n=L,r=K;try{return e()}finally{L=n,K=r}}function w(e,n){return n.condition&&!n.condition(e)||(e.source=n.open+(e.source||"")+")"),n.suffix&&(e.source+=n.suffix),e}function k(e){return w(e,{condition:function(e){return("regexp"===e.kind||"result"===e.kind)&&ve(e)},open:"(?:"})}function v(e){if("number"==typeof e||"string"==typeof e)return{key:null,kind:"string",source:String(e).replace(se,"\\$&")};throw new TypeError("Can't compose type "+typeof e+" as RegExp")}function m(e,r,t,u){return t=t||e.length>1,V.call(e,function e(u){return(!r&&t?k:n)(Array.isArray(u)?m(u,!1,t,0):"function"==typeof u?e(x(u)):u instanceof Y?g(d({key:u,kind:"regexp",source:f(u)})):v(u))}).map(p).map(s(u)).reduceRight(h(r),{key:ye.set(null,Object.assign({direction:L.hasRefs?Re.current:0,isDisjunction:r&&(e.length>1||1===e.length&&e[0]instanceof Y&&ye.get(e[0],"isDisjunction")),unicode:K.U},L)),kind:"result",source:null})}function b(){return(K.I?"i":"")+(H?"":K.M?"m":"")+(K.U?"u":"")}function E(e,n){n=n||{};var r=Q.call(n,"flags")?n.flagsOp(b(),n.flags):b(),t=n.either,u=new RegExp(t?e.source||"[]":e.source||"",r);return ye.set(u,ye.set(e.key,{})),ye.set(u,"source",e.source),Q.call(n,"direction")&&ye.set(u,"direction",n.direction),u}function R(e){if(!H)throw new Error("no support for /(?<=...)/ which is required by "+e+"()")}function S(){return arguments.length?(y(),E(m(arguments,!0,!1,0),{either:!0})):$e}function $(){return m(arguments,!1,!1,0)}function A(){return arguments.length?(y(),E($.apply(null,arguments))):Se}function O(e,n,r,t,u){return function(){if(null!=t&&t(u),!arguments.length)return r;var i=Re.current;Re.current=n;try{y();return E(w($.apply(null,arguments),{open:e}),{direction:0})}finally{Re.current=i}}}function I(){if(y(),1===arguments.length)throw new SyntaxError("Suffix to an empty prefix");return E(w(_e.apply($,arguments),{condition:l,open:"(?:",suffix:this}))}function j(e){"string"!=typeof e&&(e="{"+String(e)+"}");var n=e.match(pe);if(!n||n[3]&&Number(n[3])<Number(n[2]))throw new SyntaxError("Invalid suffix '"+e+"'.");return 1===arguments.length?I.bind(e,e):I.apply(e,arguments)}function _(e){return!J||ue.test(r(e))}function B(e){var n=typeof e;return"string"===n&&_(e)||"number"===n&&0<e&&Math.round(e)===e}function F(e,n){if(!B(e))throw new SyntaxError("Bad ref: "+e);if(null!=n&&("number"!=typeof n||n<1||n!==n|0))throw new RangeError("Bad depth: "+n);if("string"==typeof e)return new RegExp("\\k<"+e+">");var r=new RegExp("$d:"+(n||"0")+",n:"+e+"^");return ye.set(r,{direction:Re.current,hasFinalRef:!0,hasRefs:!0}),r}function M(){return y(),E(w(m(arguments,!1,!1,1),{open:"("}))}function C(e){if("string"!=typeof e)throw new TypeError("String expected, got "+typeof e);return _(e),y(),E(w(m(X.call(arguments,1),!1,!1,1),{open:"(?<"+e+">"}))}function D(e){return 1===arguments.length?C.bind(null,e):C.apply(null,arguments)}function U(e,n){return e=e.split(""),n.split("").forEach(function(n){-1===e.indexOf(n)&&e.push(n)}),e.sort().join("")}function N(e){return y(),-1!==e.indexOf("u")&&(K.U=!0),E(_e.apply($,arguments),{flagsOp:this,flags:e})}function T(){return 1===Re.current?A(Ae(M.apply(null,arguments)),F(1)):A(F(1),Ie(M.apply(null,arguments)))}function W(e,n){return A(Oe(n),e)}function P(e,n){return A(Ae(n),e)}function z(e){return W(J&&e.unicode?Me:/[^]/,e)}function Z(e){return R("bound"),S([je(e),Ae(e)],[Ie(e),Oe(e)])}function q(e){return R("noBound"),S([je(e),Oe(e)],[Ie(e),Ae(e)])}var G=[];"dgimsuy".split("").forEach(function(e){try{new RegExp("",e),G.push(e)}catch(e){}});var J=-1!==G.indexOf("u"),H=!1;try{new RegExp("(?<=)"),H=!0}catch(e){}var K,L,Q={}.hasOwnProperty,V=[].map,X=[].slice,Y=RegExp,ee={value:void 0,writable:!1,enumerable:!1,configurable:!1},ne="undefined"!=typeof WeakMap?new WeakMap:{key:"__$$__compose_regexp__$$__"+t()+t()+t()+t(),set:function(e,n){var r=typeof e;if(null==e||"object"!==r&&"function"!==r)throw new TypeError("Bad WeakMap key");var t=e[ne.key];if(!t)return ee.value={keys:[this],values:[n]},Object.defineProperty(e,ne.key,ee),this;var u=t.keys.indexOf(this);return 0===u?(t.keys.push(this),t.values.push(n),this):(t.values[u]=n,this)},get:function(e){var n=e[ne.key];if(n){var r=n.keys.indexOf(this);if(-1!==r)return n.values[r]}}},re=/\\[^]|\(\?(?::|<?[=!])|[\[\](]/g,te=/\\.|\.|\(\?:\^\|\(\?<=\[\\n\\r\\u2028\\u2029\]\)\)|\(\?:\$\|\(\?=\[\\n\\r\\u2028\\u2029\]\)\)|\[|\]|\^|\$/g,ue=J&&new RegExp("^[_$\\p{ID_Start}][$\\p{ID_Continue}]*$","u"),ie=/\\.|\{\d+,?\d*\}|(\[|\]|\{|\})/g,oe=/(?:$|(?=[\n\r\u2028\u2029]))/,fe=/(?:^|(?<=[\n\r\u2028\u2029]))/,ce=/\\[^1-9]|[\[\]]|\\(\d{1,2})|\$d:(\d+),n:(\d+)\^/g,le=/^(?:\\.|\[(?:[^\]\\]|\\.)*\])$/,ae=/^\\p\{[A-Za-z][A-Za-z=]*\}$/,se=/[.?*+^$[\]\\(){}|]/g,pe=/^(?:[+*?]|\{(?=((\d+)))\1,?(\d*)\})\??$/,de=/(\\.)|[-()|\[\]]((?=\?<?[=!]))?/g,ge=/\\u[0-9A-Fa-f]{4}|\\x[0-9A-Fa-f]{2}|\\c[A-Za-z]|\\([^.?*+^$[\]\\(){}|\/DSWdswfnrtv-])|(\\[DSWdsw]-[^\]]|.-\\[DSWdsw])|\\.|\]/g,he=/\\u[0-9A-Fa-f]{4}|\\x[0-9A-Fa-f]{2}|\\c[A-Za-z]|\\k<(.*?)>|\\([^.?*+^$[\]\\(){}|\/DSWdswBbfnrtv])|\\.|\.|\[\^\]|\[|(\((?:\?[^])?)|(\)(?:[+?*]|\{\d+,?\d*\})?)/g,ye={set:function(e,n,r){var t=i(e);return"object"==typeof n?Object.assign(t,n):t[n]=r},get:function(e,n){return i(e)[n]}},xe=[],we=o("captureCount",function(e){var n,r=0;for(re.lastIndex=0;n=re.exec(e.source);)"("===n[0]&&(r+=1);return r}),ke=o("hasRefs",function(e){var n,r=!1,t=!1,u=!1;for(ce.lastIndex=0;n=ce.exec(e.source);)u||null==n[1]&&null==n[2]?"["===n[0]?u=!0:"]"===n[0]&&(u=!1):(r=!0,ce.lastIndex===e.source.length&&(t=!0));return ye.set(e.key,"hasFinalRef",t),r}),ve=o("isDisjunction",function(e){if(-1===e.source.indexOf("|"))return!1;var n,r=0,t=!1;for(de.lastIndex=0;n=de.exec(e.source);)if(null==n[1]&&(t||"("!==n[0]||r++,t||")"!==n[0]||r--,t||"["!==n[0]&&"[-"!==n[0]||(t=!0),t&&"]"===n[0]&&(t=!1),0===r&&!t&&"|"===n[0]))return!0;return!1}),me=o("isOneGroupOrAssertion",function(e){var n=e.source;if("("!==n.charAt(0)||")"!==n.charAt(n.length-1))return!1;var r,t=0,u=!1;for(de.lastIndex=0;r=de.exec(n);)if(null==r[1]){if(u||"("!==r[0]||t++,!u&&")"===r[0]&&0===--t&&r.index!==n.length-1)return!1;u||"["!==r[0]&&"[-"!==r||(u=!0),u&&"]"===r[0]&&(u=!1)}else if(r.index===n.length-2)return!1;return!0}),be=new RegExp("^(?:(["+G.join("")+"])(?!.*\\1))*$"),Ee={"-1":"backward",1:"forward"},Re={current:1},Se=/(?:)/,$e=/[]/,Ae=O("(?=",1,Se),Oe=O("(?!",1,$e),Ie=O("(?<=",-1,Se,R,"lookBehind"),je=O("(?<!",-1,$e,R,"notBehind"),_e=I.call,Be=j("?"),Fe={add:function(e){if("string"!=typeof e)throw TypeError("String expected as first argument, got "+typeof e);if(!be.test(e))throw new SyntaxError("Invalid flags: "+e);return 1===arguments.length?N.bind(U,e):N.apply(U,arguments)}},Me=J&&new RegExp("[^]","u"),Ce={difference:W,intersection:P,complement:z,union:S};e.atomic=T,e.bound=Z,e.capture=M,e.charSet=Ce,e.either=S,e.flags=Fe,e.lookAhead=Ae,e.lookBehind=Ie,e.maybe=Be,e.namedCapture=D,e.noBound=q,e.notAhead=Oe,e.notBehind=je,e.ref=F,e.sequence=A,e.suffix=j,Object.defineProperty(e,"__esModule",{value:!0})});
