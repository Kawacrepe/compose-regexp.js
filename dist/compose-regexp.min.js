/**@license MIT-compose-regexp.js-©Pierre-Yves Gérardy*/
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define("compose-regexp",["exports"],n):(e="undefined"!=typeof globalThis?globalThis:e||self,n(e.composeRegexp={}))}(this,function(e){"use strict";function n(e){return e}function r(e){return-1===e.indexOf("\\")?e:JSON.parse('"'+e.replace(/$|"|\\x([\dA-Fa-f]{2})|\\u\{([\dA-Fa-f]{1,6})\}/g,function(e,n,r){return""===e?'"':'"'===e?'\\"':String.fromCodePoint(parseInt(n||r,16))}))}function t(){return"_"+Math.floor(Math.random()*Math.pow(2,32)).toString(36)}function u(){return{captureCount:null,direction:0,hasRefs:null,hasFinalRef:null,isDisjunction:null,isOneGroupOrAssertion:null,source:null,unicode:null}}function i(e){if(e instanceof H){var n=L.get(e);return null==n&&L.set(e,n=u()),n}return e||u()}function o(e,n){return Object.defineProperty(function(r){var t=Q.get(r.key,e);return null!=t?t:Q.set(r.key,e,n(r))},"name",{value:e})}function f(e){return Q.get(e,"source")||Q.set(e,"source",e.source)}function l(e){function n(e){e.lastIndex=u.lastIndex,u=e}var t,u=V;for(ee.length=0,V.lastIndex=0;t=u.exec(e);)if(u===V)if("["===t[0])n(X);else{if("."===t[0]||"[^]"===t[0]||null!=t[1]&&!Y.test(r(t[1]))||null!=t[2])return!0;if(null!=t[3])ee.unshift(t[3]);else if(null!=t[4]){if(("(?="===ee[0]||"(?!"===ee[0])&&")"!==t[4])return!0;ee.shift()}}else if("]"===t[0])n(V);else if(null!=t[1]||null!=t[2])return!0;return!1}function a(e){var n=e.source;if(null==n||"^"===n||"$"===n||"\\b"===n||"\\B"===n)throw new SyntaxError("Nothing to repeat: /"+(n||"(?:)")+"/");if(1===n.length||le.test(n)||z.U&&ae.test(n))return!1;if(!fe(e))return!0;if(/^\(\?<?[!=]/.test(n))throw new SyntaxError("Nothing to repeat: /"+n+"/");return!1}function s(e){var n=!1;return e.replace(se,function(e){if("["===e&&(n=!0),"]"===e){if(!n)return"\\]";n=!1}return n||"}"!==e?e:"\\}"})}function c(e){var n=e;return function(e){if("regexp"===e.kind||"result"===e.kind){if(ue(e)){Z.hasRefs=!0;var r=!1;e.source=e.source.replace(te,function(e,t,u,i){if(!r){if(null!=t){var o=Number(t)+n;if(o>99)throw new RangeError("Too many back references");return"\\"+String(o)}if(null!=u)return"0"===u?"\\"+String(i):"(?:$ ^depth:"+(Number(u)-1)+",n:"+i+")"}return"["===e?r=!0:"]"===e&&(r=!1),e})}Z.hasFinalRef=!!Q.get(e.key,"hasFinalRef"),n+=re(e)}return Z.captureCount=n,e}}function p(e){var n=e.source;if(z.U&&("regexp"===e.kind&&!e.key.unicode||"result"===e.kind&&!Q.get(e.key,"unicode"))){if(l(n))throw new SyntaxError("Can't upgrade the RegExp to Unicode /"+n+"/"+e.kind=="regexp"?e.key.flags:"");e.source=s(n)}var r=!1;return"regexp"===e.kind&&(e.key.dotAll||e.key.multiline)&&(e.source=n.replace(ce,function(n){return r?("]"===n&&(r=!1),n):("["===n&&(r=!0),e.key.dotAll&&"."===n?"[^]":e.key.multiline&&"^"===n&&W?"(?:^|(?<=[\\n\\r\\u2028\\u2029]))":e.key.multiline&&"$"===n&&W?"(?:$|(?=[\\n\\r\\u2028\\u2029]))":n)})),e}function d(e){var n=e.key.flags;if(!pe.test(n))throw new TypeError("Unkown flags: "+n.replace(new RegExp("["+B.join()+"]","g"),""));var r=!!e.key.unicode,t=e.key.ignoreCase,u=e.key.multiline;if(null!=z.I&&t!==z.I)throw new SyntaxError("Can't combine i and non-i regexps: "+e.key);if(!W&&null!=z.M&&t!==z.M)throw new SyntaxError("Can't combine m and non-m regexps: "+e.key);return z.I=t,z.M=u,z.U=z.U||r,e}function g(e){var n=Q.get(e.key,"direction");if(n*ge.current==-1)throw new TypeError("Illegal "+de[n]+" RegExp argument while building a "+de[ge.current]+" one: /"+e.source+"/");return 0!==n&&(Z.hasRefs=!0),e}function y(e){return e?function(e,n){return e.source=null==e.source?n.source:n.source+"|"+e.source,e}:function(e,n){return e.source=null==e.source?n.source:n.source+("string"!==n.kind&&ue(n)&&Q.get(n.key,"hasFinalRef")&&/^\d/.test(e.source)?"(?:)":"")+e.source,e}}function h(){Z={hasRefs:!1,hasFinalRef:!1,captureCount:0},z={U:!1,I:null,M:null}}function x(e){var n=Z,r=z;try{return e()}finally{Z=n,z=r}}function w(e,n){return n.condition&&!n.condition(e)||(e.source=n.wrapper[0]+(e.source||"")+n.wrapper[1]),n.suffix&&(e.source+=n.suffix),e}function k(e){return w(e,{condition:function(e){return("regexp"===e.kind||"result"===e.kind)&&oe(e)},wrapper:["(?:",")"]})}function v(e){if("number"==typeof e||"string"==typeof e)return{key:null,kind:"string",source:String(e).replace(ye,"\\$&")};throw new TypeError("Can't compose type "+typeof e+" as RegExp")}function m(e,r,t,u){return t=t||e.length>1,q.call(e,function e(u){return(!r&&t?k:n)(Array.isArray(u)?m(u,!1,t,0):"function"==typeof u?e(x(u)):u instanceof H?g(d({key:u,kind:"regexp",source:f(u)})):v(u))}).map(p).map(c(u)).reduceRight(y(r),{key:Q.set(null,Object.assign({direction:Z.hasRefs?ge.current:0,isDisjunction:r&&(e.length>1||1===e.length&&e[0]instanceof H&&Q.get(e[0],"isDisjunction")),unicode:z.U},Z)),kind:"result",source:null})}function b(){return(z.I?"i":"")+(W?"":z.M?"m":"")+(z.U?"u":"")}function E(e,n){n=n||{};var r=G.call(n,"flags")?n.flagsOp(b(),n.flags):b(),t=new RegExp(e.source||"",r);return Q.set(t,Q.set(e.key,{})),Q.set(t,"source",e.source),G.call(n,"direction")&&Q.set(t,"direction",n.direction),t}function R(){return arguments.length?(h(),E(m(arguments,!0,!1,0))):he}function $(){return m(arguments,!1,!1,0)}function S(){return arguments.length?(h(),E($.apply(null,arguments))):he}function O(e,n,r){return function(){if(!arguments.length)return he;var t=ge.current;ge.current=r;try{h();return E(w($.apply(null,arguments),{wrapper:[e,n]}),{direction:0})}finally{ge.current=t}}}function I(){return h(),E(w(be.apply($,arguments),{condition:a,wrapper:["(?:",")"],suffix:this}))}function j(e){"string"!=typeof e&&(e="{"+String(e)+"}");var n=e.match(me);if(!n||n[2]&&Number(n[2])<Number(n[1]))throw new SyntaxError("Invalid suffix '"+e+"'.");return 1===arguments.length?I.bind(e,e):I.apply(e,arguments)}function A(e){return!P||Y.test(r(e))}function _(e){var n=typeof e;return"string"===n&&A(e)||"number"===n&&0<e&&Math.round(e)===e}function C(e,n){if(!_(e))throw new SyntaxError("Bad ref: "+e);if(null!=n&&("number"!=typeof n||n<1||n!==n|0))throw new RangeError("Bad depth: "+n);if("string"==typeof e)return new RegExp("\\k<"+e+">");var r=new RegExp("(?:$ ^depth:"+(n||"0")+",n:"+e+")");return Q.set(r,{direction:ge.current,hasFinalRef:!0,hasRefs:!0}),r}function M(){return h(),E(w(m(arguments,!1,!1,1),{wrapper:["(",")"]}))}function D(e){if("string"!=typeof e)throw new TypeError("String expected, got "+typeof e);return A(e),h(),E(w(m(J.call(arguments,1),!1,!1,1),{wrapper:["(?<"+e+">",")"]}))}function U(e){return 1===arguments.length?D.bind(null,e):D.apply(null,arguments)}function F(){return 1===ge.current?S(xe(M.apply(null,arguments)),C(1)):S(C(1),ke(M.apply(null,arguments)))}function T(e,n){return e=e.split(""),n.split("").forEach(function(n){-1===e.indexOf(n)&&e.push(n)}),e.sort().join("")}function N(e){return h(),-1!==e.indexOf("u")&&(z.U=!0),E(be.apply($,arguments),{flagsOp:this,flags:e})}var B=[];"dgimsuy".split("").forEach(function(e){try{new RegExp("",e),B.push(e)}catch(e){}});var P=-1!==B.indexOf("u"),W=!1;try{new RegExp("(?<=)"),W=!0}catch(e){}var z,Z,G={}.hasOwnProperty,q=[].map,J=[].slice,H=RegExp,K={value:void 0,writable:!1,enumerable:!1,configurable:!1},L={key:"__$$__compose_regexp__$$__"+t()+t()+t()+t(),set:function(e,n){var r=typeof e;if(null==e||"object"!==r&&"function"!==r)throw new TypeError("Bad WeakMap key");var t=e[L.key];if(!t)return K.value={keys:[this],values:[n]},Object.defineProperty(e,L.key,K),this;var u=t.keys.indexOf(this);return 0===u?(t.keys.push(this),t.values.push(n),this):(t.values[u]=n,this)},get:function(e){var n=e[L.key];if(n){var r=n.keys.indexOf(this);if(-1!==r)return n.values[r]}}},Q={set:function(e,n,r){var t=i(e);return"object"==typeof n?Object.assign(t,n):t[n]=r},get:function(e,n){return i(e)[n]}},V=/\\u\d{4}|\\x\d{2}|\\k<(.*?)>|\\c[A-Za-z]|\\([^.?*+^$[\]\\(){}|\/DSWdswfnrtv])|\[\^\]|\.|[\[]|(\((?:\?[^])?)|(\)(?:[+?*]|\{\d+,?\d?\})?)/g,X=/\\u\d{4}|\\x\d{2}|\\c[A-Za-z]|(\\[DSWdsw]-[^\]]|.-\\[DSWdsw])|\\([^.?*+^$[\]\\(){}|\/DSWdswfnrtv-])|[\]]/g,Y=P&&new RegExp("^[_$\\p{ID_Start}][$\\p{ID_Continue}]*","u"),ee=[],ne=/\\[^]|\(\?[^<]|[\[\](]/g,re=o("captureCount",function(e){var n,r=0;for(ne.lastIndex=0;n=ne.exec(e.source);)"("===n[0]&&(r+=1);return r}),te=/\\[^1-9]|[\[\]]|\\(\d{1,2})|\(\?:\$ \^depth:(\d+),n:(\d+)\)/g,ue=o("hasRefs",function(e){var n,r=!1,t=!1,u=!1;for(te.lastIndex=0;n=te.exec(e.source);)u||null==n[1]&&null==n[2]?"["===n[0]?u=!0:"]"===n[0]&&(u=!1):(r=!0,te.lastIndex===e.source.length&&(t=!0));return Q.set(e.key,"hasFinalRef",t),r}),ie=/(\\.)|[-()|\[\]]((?=\?(?:=|!|<=|<!))?)/g,oe=o("isDisjunction",function(e){if(-1===e.source.indexOf("|"))return!1;var n,r=0,t=!1;for(ie.lastIndex=0;n=ie.exec(e.source);)if(null==n[1]&&(t||"("!==n[0]||r++,t||")"!==n[0]||r--,t||"["!==n[0]&&"[-"!==n[0]||(t=!0),t&&"]"===n[0]&&(t=!1),0===r&&!t&&"|"===n[0]))return!0;return!1}),fe=o("isOneGroupOrAssertion",function(e){var n=e.source;if("("!==n.charAt(0)||")"!==n.charAt(n.length-1))return!1;var r,t=0,u=!1;for(ie.lastIndex=0;r=ie.exec(n);)if(null==r[1]){if(u||"("!==r[0]||t++,!u&&")"===r[0]&&0===--t&&r.index!==n.length-1)return!1;u||"["!==r[0]&&"[-"!==r||(u=!0),u&&"]"===r[0]&&(u=!1)}else if(r.index===n.length-2)return!1;return!0}),le=/^\\[^]$|^\[(?:\\[^]|[^\]])*\]$/,ae=/^\\p\{[A-Z-a-z][A-Za-z=]*\}$/,se=/\{\d+,?\d*\}|\\[^]|\]|\[|\}/g,ce=/\\.|\.|\(\?:\^\|\(\?<=\[\\n\\r\\u2028\\u2029\]\)\)|\(\?:\$\|\(\?=\[\\n\\r\\u2028\\u2029\]\)\)|\[|\]|\^|\$/g,pe=new RegExp("^(?:(["+B.join("")+"])(?!.*\\1))*$"),de={"-1":"backward",1:"forward"},ge={current:1},ye=/[.?*+^$[\]\\(){}|]/g,he=/(?:)/,xe=O("(?=",")",1),we=O("(?!",")",1),ke=O("(?<=",")",-1),ve=O("(?<!",")",-1),me=/^(?:\+|\*|\?|\{(\d+),?(\d*)\})\??$/,be=I.call,Ee=j("?"),Re={add:function(e){if("string"!=typeof e)throw TypeError("String expected as first argument, got "+typeof e);if(!pe.test(e))throw new SyntaxError("Invalid flags: "+e);return 1===arguments.length?N.bind(T,e):N.apply(T,arguments)}};e.atomic=F,e.avoid=we,e.capture=M,e.either=R,e.flags=Re,e.lookAhead=xe,e.lookBehind=ke,e.maybe=Ee,e.namedCapture=U,e.notBehind=ve,e.ref=C,e.sequence=S,e.suffix=j,Object.defineProperty(e,"__esModule",{value:!0})});
